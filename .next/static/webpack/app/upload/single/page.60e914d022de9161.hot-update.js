"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("app/upload/single/page",{

/***/ "(app-pages-browser)/./hooks/useFirebaseDrafts.ts":
/*!************************************!*\
  !*** ./hooks/useFirebaseDrafts.ts ***!
  \************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   useFirebaseDrafts: () => (/* binding */ useFirebaseDrafts)\n/* harmony export */ });\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"(app-pages-browser)/./node_modules/next/dist/compiled/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _lib_firebase_draft_service__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/firebase-draft-service */ \"(app-pages-browser)/./lib/firebase-draft-service.ts\");\n/* harmony import */ var sonner__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! sonner */ \"(app-pages-browser)/./node_modules/sonner/dist/index.mjs\");\n// React hook for Firebase draft management with real-time updates\n\n\n\nconst useFirebaseDrafts = function() {\n    let options = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : {};\n    const { userId = 'anonymous', enableRealTime = true } = options;\n    const [drafts, setDrafts] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)([]);\n    const [isLoading, setIsLoading] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(true);\n    const [error, setError] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null);\n    const [isOnline, setIsOnline] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(navigator.onLine);\n    const [lastSyncTime, setLastSyncTime] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null);\n    const [trackingStats, setTrackingStats] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)({\n        totalDrafts: 0,\n        autoSavedCount: 0,\n        manualSavedCount: 0,\n        aiPopulatedCount: 0\n    });\n    const unsubscribeRef = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);\n    const saveTimeoutRef = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);\n    // Monitor online status\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)({\n        \"useFirebaseDrafts.useEffect\": ()=>{\n            const handleOnline = {\n                \"useFirebaseDrafts.useEffect.handleOnline\": ()=>{\n                    setIsOnline(true);\n                    sonner__WEBPACK_IMPORTED_MODULE_2__.toast.success('Connection restored - syncing data...');\n                    refreshDrafts();\n                }\n            }[\"useFirebaseDrafts.useEffect.handleOnline\"];\n            const handleOffline = {\n                \"useFirebaseDrafts.useEffect.handleOffline\": ()=>{\n                    setIsOnline(false);\n                    sonner__WEBPACK_IMPORTED_MODULE_2__.toast.warning('Connection lost - data will sync when reconnected');\n                }\n            }[\"useFirebaseDrafts.useEffect.handleOffline\"];\n            window.addEventListener('online', handleOnline);\n            window.addEventListener('offline', handleOffline);\n            return ({\n                \"useFirebaseDrafts.useEffect\": ()=>{\n                    window.removeEventListener('online', handleOnline);\n                    window.removeEventListener('offline', handleOffline);\n                }\n            })[\"useFirebaseDrafts.useEffect\"];\n        }\n    }[\"useFirebaseDrafts.useEffect\"], []);\n    // Calculate tracking stats when drafts change\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)({\n        \"useFirebaseDrafts.useEffect\": ()=>{\n            const stats = {\n                totalDrafts: drafts.length,\n                autoSavedCount: drafts.filter({\n                    \"useFirebaseDrafts.useEffect\": (d)=>d.autoSaved\n                }[\"useFirebaseDrafts.useEffect\"]).length,\n                manualSavedCount: drafts.filter({\n                    \"useFirebaseDrafts.useEffect\": (d)=>!d.autoSaved\n                }[\"useFirebaseDrafts.useEffect\"]).length,\n                aiPopulatedCount: drafts.filter({\n                    \"useFirebaseDrafts.useEffect\": (d)=>d.aiPopulatedFields && d.aiPopulatedFields.length > 0\n                }[\"useFirebaseDrafts.useEffect\"]).length\n            };\n            setTrackingStats(stats);\n        }\n    }[\"useFirebaseDrafts.useEffect\"], [\n        drafts\n    ]);\n    // Set up real-time listener or fetch drafts\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)({\n        \"useFirebaseDrafts.useEffect\": ()=>{\n            const initializeFirebase = {\n                \"useFirebaseDrafts.useEffect.initializeFirebase\": async ()=>{\n                    console.log('🚀 Initializing Firebase connection...');\n                    // Test Firebase connection first\n                    const connectionSuccess = await _lib_firebase_draft_service__WEBPACK_IMPORTED_MODULE_1__.FirebaseDraftService.testConnection();\n                    if (!connectionSuccess) {\n                        setError('Firebase connection failed');\n                        setIsLoading(false);\n                        return;\n                    }\n                    if (enableRealTime && isOnline) {\n                        console.log('🔥 Setting up real-time drafts listener');\n                        const unsubscribe = _lib_firebase_draft_service__WEBPACK_IMPORTED_MODULE_1__.FirebaseDraftService.onDraftsChange(userId, {\n                            \"useFirebaseDrafts.useEffect.initializeFirebase.unsubscribe\": (updatedDrafts)=>{\n                                console.log(\"\\uD83D\\uDCE1 Real-time update: \".concat(updatedDrafts.length, \" drafts\"));\n                                setDrafts(updatedDrafts);\n                                setLastSyncTime(new Date());\n                                setIsLoading(false);\n                                setError(null);\n                            }\n                        }[\"useFirebaseDrafts.useEffect.initializeFirebase.unsubscribe\"]);\n                        unsubscribeRef.current = unsubscribe;\n                        return ({\n                            \"useFirebaseDrafts.useEffect.initializeFirebase\": ()=>{\n                                console.log('🔥 Cleaning up real-time drafts listener');\n                                unsubscribe();\n                            }\n                        })[\"useFirebaseDrafts.useEffect.initializeFirebase\"];\n                    } else {\n                        // Fallback to manual fetch\n                        refreshDrafts();\n                    }\n                }\n            }[\"useFirebaseDrafts.useEffect.initializeFirebase\"];\n            initializeFirebase();\n        }\n    }[\"useFirebaseDrafts.useEffect\"], [\n        userId,\n        enableRealTime,\n        isOnline\n    ]);\n    // Cleanup on unmount\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)({\n        \"useFirebaseDrafts.useEffect\": ()=>{\n            return ({\n                \"useFirebaseDrafts.useEffect\": ()=>{\n                    if (unsubscribeRef.current) {\n                        unsubscribeRef.current();\n                    }\n                    if (saveTimeoutRef.current) {\n                        clearTimeout(saveTimeoutRef.current);\n                    }\n                }\n            })[\"useFirebaseDrafts.useEffect\"];\n        }\n    }[\"useFirebaseDrafts.useEffect\"], []);\n    const refreshDrafts = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)({\n        \"useFirebaseDrafts.useCallback[refreshDrafts]\": async ()=>{\n            if (!isOnline) {\n                setError('Cannot refresh drafts - you are offline');\n                return;\n            }\n            try {\n                setIsLoading(true);\n                setError(null);\n                const updatedDrafts = await _lib_firebase_draft_service__WEBPACK_IMPORTED_MODULE_1__.FirebaseDraftService.getAllDrafts(userId);\n                setDrafts(updatedDrafts);\n                setLastSyncTime(new Date());\n                console.log(\"\\uD83D\\uDCE1 Manual refresh: \".concat(updatedDrafts.length, \" drafts loaded\"));\n            } catch (err) {\n                const errorMessage = err instanceof Error ? err.message : 'Failed to load drafts';\n                setError(errorMessage);\n                console.error('Failed to refresh drafts:', err);\n            } finally{\n                setIsLoading(false);\n            }\n        }\n    }[\"useFirebaseDrafts.useCallback[refreshDrafts]\"], [\n        userId,\n        isOnline\n    ]);\n    const saveDraft = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)({\n        \"useFirebaseDrafts.useCallback[saveDraft]\": async (data, imageFile)=>{\n            if (!isOnline) {\n                console.log('❌ Cannot save draft - offline');\n                sonner__WEBPACK_IMPORTED_MODULE_2__.toast.error('Cannot save draft - you are offline');\n                return null;\n            }\n            try {\n                console.log('💾 Hook: Starting save draft process');\n                console.log('💾 Draft data:', data);\n                // Add user ID to draft data\n                const draftData = {\n                    ...data,\n                    userId\n                };\n                console.log('💾 Draft data with userId:', draftData);\n                const draftId = await _lib_firebase_draft_service__WEBPACK_IMPORTED_MODULE_1__.FirebaseDraftService.saveDraft(draftData, imageFile);\n                console.log('✅ Hook: Draft saved with ID:', draftId);\n                // Show success toast\n                const isUpdate = Boolean(data.id);\n                sonner__WEBPACK_IMPORTED_MODULE_2__.toast.success(isUpdate ? 'Draft updated successfully' : 'Draft saved successfully');\n                return draftId;\n            } catch (err) {\n                const errorMessage = err instanceof Error ? err.message : 'Failed to save draft';\n                console.error('❌ Hook: Save draft failed:', err);\n                setError(errorMessage);\n                sonner__WEBPACK_IMPORTED_MODULE_2__.toast.error(\"Failed to save draft: \".concat(errorMessage));\n                return null;\n            }\n        }\n    }[\"useFirebaseDrafts.useCallback[saveDraft]\"], [\n        userId,\n        isOnline\n    ]);\n    const deleteDraft = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)({\n        \"useFirebaseDrafts.useCallback[deleteDraft]\": async (id)=>{\n            if (!isOnline) {\n                sonner__WEBPACK_IMPORTED_MODULE_2__.toast.error('Cannot delete draft - you are offline');\n                return false;\n            }\n            try {\n                console.log('🗑️ Deleting draft:', id);\n                const success = await _lib_firebase_draft_service__WEBPACK_IMPORTED_MODULE_1__.FirebaseDraftService.deleteDraft(id);\n                if (success) {\n                    console.log('✅ Draft deleted successfully');\n                    sonner__WEBPACK_IMPORTED_MODULE_2__.toast.success('Draft deleted successfully');\n                    return true;\n                } else {\n                    sonner__WEBPACK_IMPORTED_MODULE_2__.toast.error('Failed to delete draft');\n                    return false;\n                }\n            } catch (err) {\n                const errorMessage = err instanceof Error ? err.message : 'Failed to delete draft';\n                setError(errorMessage);\n                sonner__WEBPACK_IMPORTED_MODULE_2__.toast.error(\"Failed to delete draft: \".concat(errorMessage));\n                console.error('Failed to delete draft:', err);\n                return false;\n            }\n        }\n    }[\"useFirebaseDrafts.useCallback[deleteDraft]\"], [\n        isOnline\n    ]);\n    const getDraft = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)({\n        \"useFirebaseDrafts.useCallback[getDraft]\": async (id)=>{\n            if (!isOnline) {\n                sonner__WEBPACK_IMPORTED_MODULE_2__.toast.error('Cannot load draft - you are offline');\n                return null;\n            }\n            try {\n                console.log('📄 Loading draft:', id);\n                const draft = await _lib_firebase_draft_service__WEBPACK_IMPORTED_MODULE_1__.FirebaseDraftService.getDraft(id);\n                if (draft) {\n                    console.log('✅ Draft loaded:', draft.creativeFilename);\n                } else {\n                    console.log('❌ Draft not found:', id);\n                }\n                return draft;\n            } catch (err) {\n                const errorMessage = err instanceof Error ? err.message : 'Failed to load draft';\n                setError(errorMessage);\n                sonner__WEBPACK_IMPORTED_MODULE_2__.toast.error(\"Failed to load draft: \".concat(errorMessage));\n                console.error('Failed to load draft:', err);\n                return null;\n            }\n        }\n    }[\"useFirebaseDrafts.useCallback[getDraft]\"], [\n        isOnline\n    ]);\n    // Auto-save functionality with debounce\n    const autoSave = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)({\n        \"useFirebaseDrafts.useCallback[autoSave]\": (data, imageFile)=>{\n            if (saveTimeoutRef.current) {\n                clearTimeout(saveTimeoutRef.current);\n            }\n            saveTimeoutRef.current = setTimeout({\n                \"useFirebaseDrafts.useCallback[autoSave]\": async ()=>{\n                    console.log('⏰ Auto-save triggered');\n                    await saveDraft({\n                        ...data,\n                        autoSaved: true\n                    }, imageFile);\n                }\n            }[\"useFirebaseDrafts.useCallback[autoSave]\"], 2000) // 2 second debounce\n            ;\n        }\n    }[\"useFirebaseDrafts.useCallback[autoSave]\"], [\n        saveDraft\n    ]);\n    return {\n        drafts,\n        isLoading,\n        error,\n        saveDraft,\n        deleteDraft,\n        getDraft,\n        refreshDrafts,\n        trackingStats,\n        isOnline,\n        lastSyncTime\n    };\n};\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL2hvb2tzL3VzZUZpcmViYXNlRHJhZnRzLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQUEsa0VBQWtFO0FBQ0Y7QUFDc0I7QUFDeEQ7QUF5QnZCLE1BQU1NLG9CQUFvQjtRQUFDQywyRUFBb0MsQ0FBQztJQUNyRSxNQUFNLEVBQUVDLFNBQVMsV0FBVyxFQUFFQyxpQkFBaUIsSUFBSSxFQUFFLEdBQUdGO0lBRXhELE1BQU0sQ0FBQ0csUUFBUUMsVUFBVSxHQUFHWCwrQ0FBUUEsQ0FBc0IsRUFBRTtJQUM1RCxNQUFNLENBQUNZLFdBQVdDLGFBQWEsR0FBR2IsK0NBQVFBLENBQUM7SUFDM0MsTUFBTSxDQUFDYyxPQUFPQyxTQUFTLEdBQUdmLCtDQUFRQSxDQUFnQjtJQUNsRCxNQUFNLENBQUNnQixVQUFVQyxZQUFZLEdBQUdqQiwrQ0FBUUEsQ0FBQ2tCLFVBQVVDLE1BQU07SUFDekQsTUFBTSxDQUFDQyxjQUFjQyxnQkFBZ0IsR0FBR3JCLCtDQUFRQSxDQUFjO0lBQzlELE1BQU0sQ0FBQ3NCLGVBQWVDLGlCQUFpQixHQUFHdkIsK0NBQVFBLENBQUM7UUFDakR3QixhQUFhO1FBQ2JDLGdCQUFnQjtRQUNoQkMsa0JBQWtCO1FBQ2xCQyxrQkFBa0I7SUFDcEI7SUFFQSxNQUFNQyxpQkFBaUJ6Qiw2Q0FBTUEsQ0FBc0I7SUFDbkQsTUFBTTBCLGlCQUFpQjFCLDZDQUFNQSxDQUF3QjtJQUVyRCx3QkFBd0I7SUFDeEJGLGdEQUFTQTt1Q0FBQztZQUNSLE1BQU02Qjs0REFBZTtvQkFDbkJiLFlBQVk7b0JBQ1paLHlDQUFLQSxDQUFDMEIsT0FBTyxDQUFDO29CQUNkQztnQkFDRjs7WUFFQSxNQUFNQzs2REFBZ0I7b0JBQ3BCaEIsWUFBWTtvQkFDWloseUNBQUtBLENBQUM2QixPQUFPLENBQUM7Z0JBQ2hCOztZQUVBQyxPQUFPQyxnQkFBZ0IsQ0FBQyxVQUFVTjtZQUNsQ0ssT0FBT0MsZ0JBQWdCLENBQUMsV0FBV0g7WUFFbkM7K0NBQU87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LGVBQWV3QixPQUFPLEdBQUdvQjsyREFBVztvQkFDbEM1QixRQUFRQyxHQUFHLENBQUM7b0JBQ1osTUFBTWMsVUFBVTt3QkFBRSxHQUFHQyxJQUFJO3dCQUFFbkIsV0FBVztvQkFBSyxHQUFHb0I7Z0JBQ2hEOzBEQUFHLE1BQU0sb0JBQW9COztRQUMvQjtrREFBRztRQUFDRjtLQUFVO0lBRWQsT0FBTztRQUNMbEQ7UUFDQUU7UUFDQUU7UUFDQThDO1FBQ0FRO1FBQ0FDO1FBQ0FyQztRQUNBVjtRQUNBTjtRQUNBSTtJQUNGO0FBQ0YsRUFBQyIsInNvdXJjZXMiOlsiRDpcXElzdGlhbiBGaWxlc1xcVGlzZWdcXENSWSBBcHBcXGhvb2tzXFx1c2VGaXJlYmFzZURyYWZ0cy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBSZWFjdCBob29rIGZvciBGaXJlYmFzZSBkcmFmdCBtYW5hZ2VtZW50IHdpdGggcmVhbC10aW1lIHVwZGF0ZXNcclxuaW1wb3J0IHsgdXNlU3RhdGUsIHVzZUVmZmVjdCwgdXNlQ2FsbGJhY2ssIHVzZVJlZiB9IGZyb20gJ3JlYWN0J1xyXG5pbXBvcnQgeyBGaXJlYmFzZURyYWZ0U2VydmljZSwgRmlyZWJhc2VEcmFmdERhdGEgfSBmcm9tICdAL2xpYi9maXJlYmFzZS1kcmFmdC1zZXJ2aWNlJ1xyXG5pbXBvcnQgeyB0b2FzdCB9IGZyb20gJ3Nvbm5lcidcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgVXNlRmlyZWJhc2VEcmFmdHNPcHRpb25zIHtcclxuICB1c2VySWQ/OiBzdHJpbmdcclxuICBlbmFibGVSZWFsVGltZT86IGJvb2xlYW5cclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBVc2VGaXJlYmFzZURyYWZ0c1JldHVybiB7XHJcbiAgZHJhZnRzOiBGaXJlYmFzZURyYWZ0RGF0YVtdXHJcbiAgaXNMb2FkaW5nOiBib29sZWFuXHJcbiAgZXJyb3I6IHN0cmluZyB8IG51bGxcclxuICBzYXZlRHJhZnQ6IChkYXRhOiBQYXJ0aWFsPEZpcmViYXNlRHJhZnREYXRhPiwgaW1hZ2VGaWxlPzogRmlsZSkgPT4gUHJvbWlzZTxzdHJpbmcgfCBudWxsPlxyXG4gIGRlbGV0ZURyYWZ0OiAoaWQ6IHN0cmluZykgPT4gUHJvbWlzZTxib29sZWFuPlxyXG4gIGdldERyYWZ0OiAoaWQ6IHN0cmluZykgPT4gUHJvbWlzZTxGaXJlYmFzZURyYWZ0RGF0YSB8IG51bGw+XHJcbiAgcmVmcmVzaERyYWZ0czogKCkgPT4gUHJvbWlzZTx2b2lkPlxyXG4gIHRyYWNraW5nU3RhdHM6IHtcclxuICAgIHRvdGFsRHJhZnRzOiBudW1iZXJcclxuICAgIGF1dG9TYXZlZENvdW50OiBudW1iZXJcclxuICAgIG1hbnVhbFNhdmVkQ291bnQ6IG51bWJlclxyXG4gICAgYWlQb3B1bGF0ZWRDb3VudDogbnVtYmVyXHJcbiAgfVxyXG4gIGlzT25saW5lOiBib29sZWFuXHJcbiAgbGFzdFN5bmNUaW1lOiBEYXRlIHwgbnVsbFxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgdXNlRmlyZWJhc2VEcmFmdHMgPSAob3B0aW9uczogVXNlRmlyZWJhc2VEcmFmdHNPcHRpb25zID0ge30pOiBVc2VGaXJlYmFzZURyYWZ0c1JldHVybiA9PiB7XHJcbiAgY29uc3QgeyB1c2VySWQgPSAnYW5vbnltb3VzJywgZW5hYmxlUmVhbFRpbWUgPSB0cnVlIH0gPSBvcHRpb25zXHJcbiAgXHJcbiAgY29uc3QgW2RyYWZ0cywgc2V0RHJhZnRzXSA9IHVzZVN0YXRlPEZpcmViYXNlRHJhZnREYXRhW10+KFtdKVxyXG4gIGNvbnN0IFtpc0xvYWRpbmcsIHNldElzTG9hZGluZ10gPSB1c2VTdGF0ZSh0cnVlKVxyXG4gIGNvbnN0IFtlcnJvciwgc2V0RXJyb3JdID0gdXNlU3RhdGU8c3RyaW5nIHwgbnVsbD4obnVsbClcclxuICBjb25zdCBbaXNPbmxpbmUsIHNldElzT25saW5lXSA9IHVzZVN0YXRlKG5hdmlnYXRvci5vbkxpbmUpXHJcbiAgY29uc3QgW2xhc3RTeW5jVGltZSwgc2V0TGFzdFN5bmNUaW1lXSA9IHVzZVN0YXRlPERhdGUgfCBudWxsPihudWxsKVxyXG4gIGNvbnN0IFt0cmFja2luZ1N0YXRzLCBzZXRUcmFja2luZ1N0YXRzXSA9IHVzZVN0YXRlKHtcclxuICAgIHRvdGFsRHJhZnRzOiAwLFxyXG4gICAgYXV0b1NhdmVkQ291bnQ6IDAsXHJcbiAgICBtYW51YWxTYXZlZENvdW50OiAwLFxyXG4gICAgYWlQb3B1bGF0ZWRDb3VudDogMFxyXG4gIH0pXHJcbiAgXHJcbiAgY29uc3QgdW5zdWJzY3JpYmVSZWYgPSB1c2VSZWY8KCgpID0+IHZvaWQpIHwgbnVsbD4obnVsbClcclxuICBjb25zdCBzYXZlVGltZW91dFJlZiA9IHVzZVJlZjxOb2RlSlMuVGltZW91dCB8IG51bGw+KG51bGwpXHJcblxyXG4gIC8vIE1vbml0b3Igb25saW5lIHN0YXR1c1xyXG4gIHVzZUVmZmVjdCgoKSA9PiB7XHJcbiAgICBjb25zdCBoYW5kbGVPbmxpbmUgPSAoKSA9PiB7XHJcbiAgICAgIHNldElzT25saW5lKHRydWUpXHJcbiAgICAgIHRvYXN0LnN1Y2Nlc3MoJ0Nvbm5lY3Rpb24gcmVzdG9yZWQgLSBzeW5jaW5nIGRhdGEuLi4nKVxyXG4gICAgICByZWZyZXNoRHJhZnRzKClcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc3QgaGFuZGxlT2ZmbGluZSA9ICgpID0+IHtcclxuICAgICAgc2V0SXNPbmxpbmUoZmFsc2UpXHJcbiAgICAgIHRvYXN0Lndhcm5pbmcoJ0Nvbm5lY3Rpb24gbG9zdCAtIGRhdGEgd2lsbCBzeW5jIHdoZW4gcmVjb25uZWN0ZWQnKVxyXG4gICAgfVxyXG5cclxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdvbmxpbmUnLCBoYW5kbGVPbmxpbmUpXHJcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignb2ZmbGluZScsIGhhbmRsZU9mZmxpbmUpXHJcblxyXG4gICAgcmV0dXJuICgpID0+IHtcclxuICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ29ubGluZScsIGhhbmRsZU9ubGluZSlcclxuICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ29mZmxpbmUnLCBoYW5kbGVPZmZsaW5lKVxyXG4gICAgfVxyXG4gIH0sIFtdKVxyXG5cclxuICAvLyBDYWxjdWxhdGUgdHJhY2tpbmcgc3RhdHMgd2hlbiBkcmFmdHMgY2hhbmdlXHJcbiAgdXNlRWZmZWN0KCgpID0+IHtcclxuICAgIGNvbnN0IHN0YXRzID0ge1xyXG4gICAgICB0b3RhbERyYWZ0czogZHJhZnRzLmxlbmd0aCxcclxuICAgICAgYXV0b1NhdmVkQ291bnQ6IGRyYWZ0cy5maWx0ZXIoZCA9PiBkLmF1dG9TYXZlZCkubGVuZ3RoLFxyXG4gICAgICBtYW51YWxTYXZlZENvdW50OiBkcmFmdHMuZmlsdGVyKGQgPT4gIWQuYXV0b1NhdmVkKS5sZW5ndGgsXHJcbiAgICAgIGFpUG9wdWxhdGVkQ291bnQ6IGRyYWZ0cy5maWx0ZXIoZCA9PiBkLmFpUG9wdWxhdGVkRmllbGRzICYmIGQuYWlQb3B1bGF0ZWRGaWVsZHMubGVuZ3RoID4gMCkubGVuZ3RoXHJcbiAgICB9XHJcbiAgICBzZXRUcmFja2luZ1N0YXRzKHN0YXRzKVxyXG4gIH0sIFtkcmFmdHNdKVxyXG5cclxuICAvLyBTZXQgdXAgcmVhbC10aW1lIGxpc3RlbmVyIG9yIGZldGNoIGRyYWZ0c1xyXG4gIHVzZUVmZmVjdCgoKSA9PiB7XHJcbiAgICBjb25zdCBpbml0aWFsaXplRmlyZWJhc2UgPSBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCfwn5qAIEluaXRpYWxpemluZyBGaXJlYmFzZSBjb25uZWN0aW9uLi4uJylcclxuICAgICAgXHJcbiAgICAgIC8vIFRlc3QgRmlyZWJhc2UgY29ubmVjdGlvbiBmaXJzdFxyXG4gICAgICBjb25zdCBjb25uZWN0aW9uU3VjY2VzcyA9IGF3YWl0IEZpcmViYXNlRHJhZnRTZXJ2aWNlLnRlc3RDb25uZWN0aW9uKClcclxuICAgICAgaWYgKCFjb25uZWN0aW9uU3VjY2Vzcykge1xyXG4gICAgICAgIHNldEVycm9yKCdGaXJlYmFzZSBjb25uZWN0aW9uIGZhaWxlZCcpXHJcbiAgICAgICAgc2V0SXNMb2FkaW5nKGZhbHNlKVxyXG4gICAgICAgIHJldHVyblxyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAoZW5hYmxlUmVhbFRpbWUgJiYgaXNPbmxpbmUpIHtcclxuICAgICAgICBjb25zb2xlLmxvZygn8J+UpSBTZXR0aW5nIHVwIHJlYWwtdGltZSBkcmFmdHMgbGlzdGVuZXInKVxyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnN0IHVuc3Vic2NyaWJlID0gRmlyZWJhc2VEcmFmdFNlcnZpY2Uub25EcmFmdHNDaGFuZ2UodXNlcklkLCAodXBkYXRlZERyYWZ0cykgPT4ge1xyXG4gICAgICAgICAgY29uc29sZS5sb2coYPCfk6EgUmVhbC10aW1lIHVwZGF0ZTogJHt1cGRhdGVkRHJhZnRzLmxlbmd0aH0gZHJhZnRzYClcclxuICAgICAgICAgIHNldERyYWZ0cyh1cGRhdGVkRHJhZnRzKVxyXG4gICAgICAgICAgc2V0TGFzdFN5bmNUaW1lKG5ldyBEYXRlKCkpXHJcbiAgICAgICAgICBzZXRJc0xvYWRpbmcoZmFsc2UpXHJcbiAgICAgICAgICBzZXRFcnJvcihudWxsKVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgXHJcbiAgICAgICAgdW5zdWJzY3JpYmVSZWYuY3VycmVudCA9IHVuc3Vic2NyaWJlXHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuICgpID0+IHtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKCfwn5SlIENsZWFuaW5nIHVwIHJlYWwtdGltZSBkcmFmdHMgbGlzdGVuZXInKVxyXG4gICAgICAgICAgdW5zdWJzY3JpYmUoKVxyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvLyBGYWxsYmFjayB0byBtYW51YWwgZmV0Y2hcclxuICAgICAgICByZWZyZXNoRHJhZnRzKClcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGluaXRpYWxpemVGaXJlYmFzZSgpXHJcbiAgfSwgW3VzZXJJZCwgZW5hYmxlUmVhbFRpbWUsIGlzT25saW5lXSlcclxuXHJcbiAgLy8gQ2xlYW51cCBvbiB1bm1vdW50XHJcbiAgdXNlRWZmZWN0KCgpID0+IHtcclxuICAgIHJldHVybiAoKSA9PiB7XHJcbiAgICAgIGlmICh1bnN1YnNjcmliZVJlZi5jdXJyZW50KSB7XHJcbiAgICAgICAgdW5zdWJzY3JpYmVSZWYuY3VycmVudCgpXHJcbiAgICAgIH1cclxuICAgICAgaWYgKHNhdmVUaW1lb3V0UmVmLmN1cnJlbnQpIHtcclxuICAgICAgICBjbGVhclRpbWVvdXQoc2F2ZVRpbWVvdXRSZWYuY3VycmVudClcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH0sIFtdKVxyXG5cclxuICBjb25zdCByZWZyZXNoRHJhZnRzID0gdXNlQ2FsbGJhY2soYXN5bmMgKCkgPT4ge1xyXG4gICAgaWYgKCFpc09ubGluZSkge1xyXG4gICAgICBzZXRFcnJvcignQ2Fubm90IHJlZnJlc2ggZHJhZnRzIC0geW91IGFyZSBvZmZsaW5lJylcclxuICAgICAgcmV0dXJuXHJcbiAgICB9XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgc2V0SXNMb2FkaW5nKHRydWUpXHJcbiAgICAgIHNldEVycm9yKG51bGwpXHJcbiAgICAgIFxyXG4gICAgICBjb25zdCB1cGRhdGVkRHJhZnRzID0gYXdhaXQgRmlyZWJhc2VEcmFmdFNlcnZpY2UuZ2V0QWxsRHJhZnRzKHVzZXJJZClcclxuICAgICAgc2V0RHJhZnRzKHVwZGF0ZWREcmFmdHMpXHJcbiAgICAgIHNldExhc3RTeW5jVGltZShuZXcgRGF0ZSgpKVxyXG4gICAgICBcclxuICAgICAgY29uc29sZS5sb2coYPCfk6EgTWFudWFsIHJlZnJlc2g6ICR7dXBkYXRlZERyYWZ0cy5sZW5ndGh9IGRyYWZ0cyBsb2FkZWRgKVxyXG4gICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9IGVyciBpbnN0YW5jZW9mIEVycm9yID8gZXJyLm1lc3NhZ2UgOiAnRmFpbGVkIHRvIGxvYWQgZHJhZnRzJ1xyXG4gICAgICBzZXRFcnJvcihlcnJvck1lc3NhZ2UpXHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byByZWZyZXNoIGRyYWZ0czonLCBlcnIpXHJcbiAgICB9IGZpbmFsbHkge1xyXG4gICAgICBzZXRJc0xvYWRpbmcoZmFsc2UpXHJcbiAgICB9XHJcbiAgfSwgW3VzZXJJZCwgaXNPbmxpbmVdKVxyXG5cclxuICBjb25zdCBzYXZlRHJhZnQgPSB1c2VDYWxsYmFjayhhc3luYyAoXHJcbiAgICBkYXRhOiBQYXJ0aWFsPEZpcmViYXNlRHJhZnREYXRhPiwgXHJcbiAgICBpbWFnZUZpbGU/OiBGaWxlXHJcbiAgKTogUHJvbWlzZTxzdHJpbmcgfCBudWxsPiA9PiB7XHJcbiAgICBpZiAoIWlzT25saW5lKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCfinYwgQ2Fubm90IHNhdmUgZHJhZnQgLSBvZmZsaW5lJylcclxuICAgICAgdG9hc3QuZXJyb3IoJ0Nhbm5vdCBzYXZlIGRyYWZ0IC0geW91IGFyZSBvZmZsaW5lJylcclxuICAgICAgcmV0dXJuIG51bGxcclxuICAgIH1cclxuXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zb2xlLmxvZygn8J+SviBIb29rOiBTdGFydGluZyBzYXZlIGRyYWZ0IHByb2Nlc3MnKVxyXG4gICAgICBjb25zb2xlLmxvZygn8J+SviBEcmFmdCBkYXRhOicsIGRhdGEpXHJcbiAgICAgIFxyXG4gICAgICAvLyBBZGQgdXNlciBJRCB0byBkcmFmdCBkYXRhXHJcbiAgICAgIGNvbnN0IGRyYWZ0RGF0YSA9IHsgLi4uZGF0YSwgdXNlcklkIH1cclxuICAgICAgY29uc29sZS5sb2coJ/Cfkr4gRHJhZnQgZGF0YSB3aXRoIHVzZXJJZDonLCBkcmFmdERhdGEpXHJcbiAgICAgIFxyXG4gICAgICBjb25zdCBkcmFmdElkID0gYXdhaXQgRmlyZWJhc2VEcmFmdFNlcnZpY2Uuc2F2ZURyYWZ0KGRyYWZ0RGF0YSwgaW1hZ2VGaWxlKVxyXG4gICAgICBcclxuICAgICAgY29uc29sZS5sb2coJ+KchSBIb29rOiBEcmFmdCBzYXZlZCB3aXRoIElEOicsIGRyYWZ0SWQpXHJcbiAgICAgIFxyXG4gICAgICAvLyBTaG93IHN1Y2Nlc3MgdG9hc3RcclxuICAgICAgY29uc3QgaXNVcGRhdGUgPSBCb29sZWFuKGRhdGEuaWQpXHJcbiAgICAgIHRvYXN0LnN1Y2Nlc3MoaXNVcGRhdGUgPyAnRHJhZnQgdXBkYXRlZCBzdWNjZXNzZnVsbHknIDogJ0RyYWZ0IHNhdmVkIHN1Y2Nlc3NmdWxseScpXHJcbiAgICAgIFxyXG4gICAgICByZXR1cm4gZHJhZnRJZFxyXG4gICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9IGVyciBpbnN0YW5jZW9mIEVycm9yID8gZXJyLm1lc3NhZ2UgOiAnRmFpbGVkIHRvIHNhdmUgZHJhZnQnXHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBIb29rOiBTYXZlIGRyYWZ0IGZhaWxlZDonLCBlcnIpXHJcbiAgICAgIHNldEVycm9yKGVycm9yTWVzc2FnZSlcclxuICAgICAgdG9hc3QuZXJyb3IoYEZhaWxlZCB0byBzYXZlIGRyYWZ0OiAke2Vycm9yTWVzc2FnZX1gKVxyXG4gICAgICByZXR1cm4gbnVsbFxyXG4gICAgfVxyXG4gIH0sIFt1c2VySWQsIGlzT25saW5lXSlcclxuXHJcbiAgY29uc3QgZGVsZXRlRHJhZnQgPSB1c2VDYWxsYmFjayhhc3luYyAoaWQ6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4gPT4ge1xyXG4gICAgaWYgKCFpc09ubGluZSkge1xyXG4gICAgICB0b2FzdC5lcnJvcignQ2Fubm90IGRlbGV0ZSBkcmFmdCAtIHlvdSBhcmUgb2ZmbGluZScpXHJcbiAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgfVxyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCfwn5eR77iPIERlbGV0aW5nIGRyYWZ0OicsIGlkKVxyXG4gICAgICBcclxuICAgICAgY29uc3Qgc3VjY2VzcyA9IGF3YWl0IEZpcmViYXNlRHJhZnRTZXJ2aWNlLmRlbGV0ZURyYWZ0KGlkKVxyXG4gICAgICBcclxuICAgICAgaWYgKHN1Y2Nlc3MpIHtcclxuICAgICAgICBjb25zb2xlLmxvZygn4pyFIERyYWZ0IGRlbGV0ZWQgc3VjY2Vzc2Z1bGx5JylcclxuICAgICAgICB0b2FzdC5zdWNjZXNzKCdEcmFmdCBkZWxldGVkIHN1Y2Nlc3NmdWxseScpXHJcbiAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0b2FzdC5lcnJvcignRmFpbGVkIHRvIGRlbGV0ZSBkcmFmdCcpXHJcbiAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSBlcnIgaW5zdGFuY2VvZiBFcnJvciA/IGVyci5tZXNzYWdlIDogJ0ZhaWxlZCB0byBkZWxldGUgZHJhZnQnXHJcbiAgICAgIHNldEVycm9yKGVycm9yTWVzc2FnZSlcclxuICAgICAgdG9hc3QuZXJyb3IoYEZhaWxlZCB0byBkZWxldGUgZHJhZnQ6ICR7ZXJyb3JNZXNzYWdlfWApXHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBkZWxldGUgZHJhZnQ6JywgZXJyKVxyXG4gICAgICByZXR1cm4gZmFsc2VcclxuICAgIH1cclxuICB9LCBbaXNPbmxpbmVdKVxyXG5cclxuICBjb25zdCBnZXREcmFmdCA9IHVzZUNhbGxiYWNrKGFzeW5jIChpZDogc3RyaW5nKTogUHJvbWlzZTxGaXJlYmFzZURyYWZ0RGF0YSB8IG51bGw+ID0+IHtcclxuICAgIGlmICghaXNPbmxpbmUpIHtcclxuICAgICAgdG9hc3QuZXJyb3IoJ0Nhbm5vdCBsb2FkIGRyYWZ0IC0geW91IGFyZSBvZmZsaW5lJylcclxuICAgICAgcmV0dXJuIG51bGxcclxuICAgIH1cclxuXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zb2xlLmxvZygn8J+ThCBMb2FkaW5nIGRyYWZ0OicsIGlkKVxyXG4gICAgICBcclxuICAgICAgY29uc3QgZHJhZnQgPSBhd2FpdCBGaXJlYmFzZURyYWZ0U2VydmljZS5nZXREcmFmdChpZClcclxuICAgICAgXHJcbiAgICAgIGlmIChkcmFmdCkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCfinIUgRHJhZnQgbG9hZGVkOicsIGRyYWZ0LmNyZWF0aXZlRmlsZW5hbWUpXHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ+KdjCBEcmFmdCBub3QgZm91bmQ6JywgaWQpXHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIHJldHVybiBkcmFmdFxyXG4gICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9IGVyciBpbnN0YW5jZW9mIEVycm9yID8gZXJyLm1lc3NhZ2UgOiAnRmFpbGVkIHRvIGxvYWQgZHJhZnQnXHJcbiAgICAgIHNldEVycm9yKGVycm9yTWVzc2FnZSlcclxuICAgICAgdG9hc3QuZXJyb3IoYEZhaWxlZCB0byBsb2FkIGRyYWZ0OiAke2Vycm9yTWVzc2FnZX1gKVxyXG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gbG9hZCBkcmFmdDonLCBlcnIpXHJcbiAgICAgIHJldHVybiBudWxsXHJcbiAgICB9XHJcbiAgfSwgW2lzT25saW5lXSlcclxuXHJcbiAgLy8gQXV0by1zYXZlIGZ1bmN0aW9uYWxpdHkgd2l0aCBkZWJvdW5jZVxyXG4gIGNvbnN0IGF1dG9TYXZlID0gdXNlQ2FsbGJhY2soKGRhdGE6IFBhcnRpYWw8RmlyZWJhc2VEcmFmdERhdGE+LCBpbWFnZUZpbGU/OiBGaWxlKSA9PiB7XHJcbiAgICBpZiAoc2F2ZVRpbWVvdXRSZWYuY3VycmVudCkge1xyXG4gICAgICBjbGVhclRpbWVvdXQoc2F2ZVRpbWVvdXRSZWYuY3VycmVudClcclxuICAgIH1cclxuXHJcbiAgICBzYXZlVGltZW91dFJlZi5jdXJyZW50ID0gc2V0VGltZW91dChhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCfij7AgQXV0by1zYXZlIHRyaWdnZXJlZCcpXHJcbiAgICAgIGF3YWl0IHNhdmVEcmFmdCh7IC4uLmRhdGEsIGF1dG9TYXZlZDogdHJ1ZSB9LCBpbWFnZUZpbGUpXHJcbiAgICB9LCAyMDAwKSAvLyAyIHNlY29uZCBkZWJvdW5jZVxyXG4gIH0sIFtzYXZlRHJhZnRdKVxyXG5cclxuICByZXR1cm4ge1xyXG4gICAgZHJhZnRzLFxyXG4gICAgaXNMb2FkaW5nLFxyXG4gICAgZXJyb3IsXHJcbiAgICBzYXZlRHJhZnQsXHJcbiAgICBkZWxldGVEcmFmdCxcclxuICAgIGdldERyYWZ0LFxyXG4gICAgcmVmcmVzaERyYWZ0cyxcclxuICAgIHRyYWNraW5nU3RhdHMsXHJcbiAgICBpc09ubGluZSxcclxuICAgIGxhc3RTeW5jVGltZVxyXG4gIH1cclxufSJdLCJuYW1lcyI6WyJ1c2VTdGF0ZSIsInVzZUVmZmVjdCIsInVzZUNhbGxiYWNrIiwidXNlUmVmIiwiRmlyZWJhc2VEcmFmdFNlcnZpY2UiLCJ0b2FzdCIsInVzZUZpcmViYXNlRHJhZnRzIiwib3B0aW9ucyIsInVzZXJJZCIsImVuYWJsZVJlYWxUaW1lIiwiZHJhZnRzIiwic2V0RHJhZnRzIiwiaXNMb2FkaW5nIiwic2V0SXNMb2FkaW5nIiwiZXJyb3IiLCJzZXRFcnJvciIsImlzT25saW5lIiwic2V0SXNPbmxpbmUiLCJuYXZpZ2F0b3IiLCJvbkxpbmUiLCJsYXN0U3luY1RpbWUiLCJzZXRMYXN0U3luY1RpbWUiLCJ0cmFja2luZ1N0YXRzIiwic2V0VHJhY2tpbmdTdGF0cyIsInRvdGFsRHJhZnRzIiwiYXV0b1NhdmVkQ291bnQiLCJtYW51YWxTYXZlZENvdW50IiwiYWlQb3B1bGF0ZWRDb3VudCIsInVuc3Vic2NyaWJlUmVmIiwic2F2ZVRpbWVvdXRSZWYiLCJoYW5kbGVPbmxpbmUiLCJzdWNjZXNzIiwicmVmcmVzaERyYWZ0cyIsImhhbmRsZU9mZmxpbmUiLCJ3YXJuaW5nIiwid2luZG93IiwiYWRkRXZlbnRMaXN0ZW5lciIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJzdGF0cyIsImxlbmd0aCIsImZpbHRlciIsImQiLCJhdXRvU2F2ZWQiLCJhaVBvcHVsYXRlZEZpZWxkcyIsImluaXRpYWxpemVGaXJlYmFzZSIsImNvbnNvbGUiLCJsb2ciLCJjb25uZWN0aW9uU3VjY2VzcyIsInRlc3RDb25uZWN0aW9uIiwidW5zdWJzY3JpYmUiLCJvbkRyYWZ0c0NoYW5nZSIsInVwZGF0ZWREcmFmdHMiLCJEYXRlIiwiY3VycmVudCIsImNsZWFyVGltZW91dCIsImdldEFsbERyYWZ0cyIsImVyciIsImVycm9yTWVzc2FnZSIsIkVycm9yIiwibWVzc2FnZSIsInNhdmVEcmFmdCIsImRhdGEiLCJpbWFnZUZpbGUiLCJkcmFmdERhdGEiLCJkcmFmdElkIiwiaXNVcGRhdGUiLCJCb29sZWFuIiwiaWQiLCJkZWxldGVEcmFmdCIsImdldERyYWZ0IiwiZHJhZnQiLCJjcmVhdGl2ZUZpbGVuYW1lIiwiYXV0b1NhdmUiLCJzZXRUaW1lb3V0Il0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(app-pages-browser)/./hooks/useFirebaseDrafts.ts\n"));

/***/ })

});